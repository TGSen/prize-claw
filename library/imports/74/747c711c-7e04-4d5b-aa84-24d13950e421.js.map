{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "phone",
    "default",
    "type",
    "Node",
    "code",
    "codeBtn",
    "submit",
    "mask",
    "spirteFrames",
    "SpriteFrame",
    "close",
    "codeBtnText",
    "Label",
    "onLoad",
    "init",
    "listen",
    "main",
    "director",
    "getScene",
    "getChildByName",
    "getComponent",
    "state",
    "wait",
    "time",
    "phoneInput",
    "EditBox",
    "codeInput",
    "shop",
    "node",
    "zIndex",
    "countDown",
    "string",
    "toString",
    "codeReset",
    "setTimeout",
    "Sprite",
    "spriteFrame",
    "on",
    "EventType",
    "TOUCH_START",
    "event",
    "stopPropagation",
    "replace",
    "scale",
    "TOUCH_END",
    "api",
    "getCaptcha",
    "then",
    "res",
    "data",
    "ok",
    "alert",
    "m",
    "bindPhone",
    "user",
    "hide",
    "show",
    "active",
    "opacity",
    "runAction",
    "fadeIn",
    "sequence",
    "fadeOut",
    "callFunc"
  ],
  "mappings": "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",
  "file": "unknown",
  "sourcesContent": [
    "export default cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        phone: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        code: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        codeBtn: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        submit: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        mask: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        spirteFrames: {\r\n            default: [],\r\n            type: cc.SpriteFrame\r\n        },\r\n\r\n        close: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        codeBtnText: {\r\n            default: null,\r\n            type: cc.Label\r\n        }\r\n    },\r\n\r\n    onLoad: function () {\r\n        this.init()\r\n        this.listen()\r\n    },\r\n\r\n    init() {\r\n        this.main = cc.director.getScene()\r\n            .getChildByName('main').getComponent('main')\r\n\r\n        // 网络请求状态\r\n        this.state = {\r\n            wait: false,\r\n            time: 0\r\n        }\r\n\r\n        this.phoneInput = this.phone.getComponent(cc.EditBox)\r\n        this.codeInput = this.code.getComponent(cc.EditBox)\r\n        this.main.shop.node.zIndex = 1\r\n    },\r\n\r\n    countDown() {\r\n        this.state.time--\r\n        this.codeBtnText.string = this.state.time.toString() + 's'\r\n        if (this.state.time === 0) {\r\n            this.codeReset()\r\n            return\r\n        }\r\n        setTimeout(() => {\r\n            this.countDown()\r\n        }, 1000)\r\n    },\r\n\r\n    codeReset() {\r\n        this.codeBtn.getComponent(cc.Sprite).spriteFrame =\r\n            this.spirteFrames[0]\r\n        this.codeBtnText.string = '获取验证码'\r\n    },\r\n\r\n    listen() {\r\n        this.mask.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            event => {\r\n                event.stopPropagation()\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 手机号输入事件监听\r\n        * 替换非数字字符为空\r\n        */\r\n\r\n        this.phone.on('text-changed',\r\n            () => {\r\n                this.phoneInput.string = this.phoneInput.string.replace(/\\D/g, '')\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 验证码输入事件监听\r\n        * 替换非数字字符为空\r\n        */\r\n\r\n        this.code.on('text-changed',\r\n            () => {\r\n                this.codeInput.string = this.codeInput.string.replace(/\\D/g, '')\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 验证码按钮监听\r\n        */\r\n        this.codeBtn.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.codeBtn.scale = .95\r\n            }\r\n        )\r\n\r\n        this.codeBtn.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.codeBtn.scale = 1\r\n                if (this.state.wait) return\r\n                if (this.state.time) return\r\n\r\n                this.state.wait = true\r\n\r\n                this.main.api.getCaptcha(this.phoneInput.string)\r\n                .then(res => {\r\n                    if (res.data.ok) {\r\n                        // 启动倒计时\r\n                        this.state.time = 60\r\n                        this.countDown()\r\n\r\n                        this.codeBtn.getComponent(cc.Sprite).spriteFrame =\r\n                            this.spirteFrames[1]\r\n                    } else {\r\n                        alert(res.data.m)\r\n                    }\r\n                    this.state.wait = false\r\n                })\r\n\r\n            }\r\n        )\r\n\r\n\r\n        /*\r\n        * 提交按钮\r\n        */\r\n        this.submit.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.submit.scale = .95\r\n            }\r\n        )\r\n\r\n        this.submit.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.submit.scale = 1\r\n\r\n                this.main.api.bindPhone(\r\n                    this.phoneInput.string,\r\n                    this.codeInput.string\r\n                ).then(res => {\r\n                    if (res.data.ok) {\r\n                        this.main.user.phone = this.phoneInput.string\r\n                        this.hide()\r\n                        this.codeInput.string = ''\r\n                        this.phoneInput.string = ''\r\n                    } else {\r\n                        alert(res.data.m)\r\n                    }\r\n                })\r\n            }\r\n        )\r\n\r\n        /*\r\n        * 关闭按钮\r\n        */\r\n        this.close.on(\r\n            cc.Node.EventType.TOUCH_START,\r\n            () => {\r\n                this.close.scale = .95\r\n            }\r\n        )\r\n\r\n        this.close.on(\r\n            cc.Node.EventType.TOUCH_END,\r\n            () => {\r\n                this.close.scale = 1\r\n                this.hide()\r\n            }\r\n        )\r\n\r\n    },\r\n\r\n    show() {\r\n        if (this.node.active) this.node.opacity = 0\r\n        else {\r\n            this.node.active = true\r\n            this.node.opacity = 0\r\n        }\r\n        this.node.runAction(cc.fadeIn(.5))\r\n    },\r\n\r\n    hide() {\r\n        this.node.runAction(cc.sequence(\r\n            cc.fadeOut(.5),\r\n            cc.callFunc(() => {\r\n                this.node.active = false\r\n            })\r\n        ))\r\n    }\r\n})\r\n"
  ]
}