{
  "version": 3,
  "sources": [
    "unknown"
  ],
  "names": [
    "cc",
    "Class",
    "extends",
    "Component",
    "properties",
    "left",
    "default",
    "type",
    "Node",
    "right",
    "rope",
    "body",
    "onLoad",
    "init",
    "setModel",
    "i",
    "getComponent",
    "Sprite",
    "spriteFrame",
    "main",
    "spriteFrames",
    "clawRopeGold",
    "clawBodyGold",
    "clawLeftGold",
    "clawRightGold",
    "clawRopeNormal",
    "clawBodyNormal",
    "clawLeftNormal",
    "clawRightNormal",
    "director",
    "getScene",
    "getChildByName",
    "actions",
    "rotate",
    "rotateBy",
    "move",
    "moveBy",
    "up",
    "scale",
    "scaleBy",
    "flop",
    "spawn",
    "repeatForever",
    "state",
    "y",
    "ropeHeight",
    "catched",
    "gift",
    "catchAnimated",
    "wait",
    "results",
    "grab",
    "func",
    "runAction",
    "reverse",
    "sequence",
    "callFunc",
    "free",
    "fall",
    "node",
    "rise",
    "bind",
    "zIndex",
    "lose",
    "grabResultInt",
    "game",
    "showResult",
    "win",
    "goods",
    "prompt",
    "show",
    "img",
    "api",
    "matchId",
    "then",
    "res",
    "data",
    "ok",
    "r",
    "user",
    "update",
    "catch",
    "random",
    "Math",
    "putItem",
    "stopAllActions",
    "catchAnimate",
    "audio",
    "play",
    "_goodsId",
    "height",
    "x"
  ],
  "mappings": ";;;;;kBAAeA,GAAGC,KAAH,CAAS;AACpBC,aAASF,GAAGG,SADQ;AAEpBC,gBAAY;AACRC,cAAM;AACFC,qBAAS,IADP;AAEFC,kBAAMP,GAAGQ;AAFP,SADE;AAKRC,eAAO;AACHH,qBAAS,IADN;AAEHC,kBAAMP,GAAGQ;AAFN,SALC;AASRE,cAAM;AACFJ,qBAAS,IADP;AAEFC,kBAAMP,GAAGQ;AAFP,SATE;AAaRG,cAAM;AACFL,qBAAS,IADP;AAEFC,kBAAMP,GAAGQ;AAFP;AAbE,KAFQ;;AAqBpBI,UArBoB,oBAqBX;AACL,aAAKC,IAAL;AACH,KAvBmB;AAyBpBC,YAzBoB,oBAyBXC,CAzBW,EAyBR;AACR,YAAIA,MAAM,CAAV,EAAa;AACT,iBAAKL,IAAL,CAAUM,YAAV,CAAuBhB,GAAGiB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,IAAL,CAAUC,YAAV,CAAuBC,YAAvE;AACA,iBAAKV,IAAL,CAAUK,YAAV,CAAuBhB,GAAGiB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,IAAL,CAAUC,YAAV,CAAuBE,YAAvE;AACA,iBAAKjB,IAAL,CAAUW,YAAV,CAAuBhB,GAAGiB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,IAAL,CAAUC,YAAV,CAAuBG,YAAvE;AACA,iBAAKd,KAAL,CAAWO,YAAX,CAAwBhB,GAAGiB,MAA3B,EAAmCC,WAAnC,GAAiD,KAAKC,IAAL,CAAUC,YAAV,CAAuBI,aAAxE;AACH,SALD,MAKO;AACH,iBAAKd,IAAL,CAAUM,YAAV,CAAuBhB,GAAGiB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,IAAL,CAAUC,YAAV,CAAuBK,cAAvE;AACA,iBAAKd,IAAL,CAAUK,YAAV,CAAuBhB,GAAGiB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,IAAL,CAAUC,YAAV,CAAuBM,cAAvE;AACA,iBAAKrB,IAAL,CAAUW,YAAV,CAAuBhB,GAAGiB,MAA1B,EAAkCC,WAAlC,GAAgD,KAAKC,IAAL,CAAUC,YAAV,CAAuBO,cAAvE;AACA,iBAAKlB,KAAL,CAAWO,YAAX,CAAwBhB,GAAGiB,MAA3B,EAAmCC,WAAnC,GAAiD,KAAKC,IAAL,CAAUC,YAAV,CAAuBQ,eAAxE;AACH;AACJ,KArCmB;AAuCpBf,QAvCoB,kBAuCb;AACH;;;;AAIA,aAAKM,IAAL,GAAYnB,GAAG6B,QAAH,CAAYC,QAAZ,GACPC,cADO,CACQ,MADR,EACgBf,YADhB,CAC6B,MAD7B,CAAZ;;AAGA;AACA,aAAKgB,OAAL,GAAe;AACXC,oBAAQjC,GAAGkC,QAAH,CAAY,EAAZ,EAAgB,EAAhB,CADG;AAEXC,kBAAMnC,GAAGoC,MAAH,CAAU,EAAV,EAAc,CAAd,EAAiB,CAAC,GAAlB,CAFK;AAGXC,gBAAIrC,GAAGoC,MAAH,CAAU,EAAV,EAAc,CAAd,EAAiB,GAAjB,CAHO;AAIXE,mBAAOtC,GAAGuC,OAAH,CAAW,EAAX,EAAe,EAAf,CAJI;AAKXC,kBAAMxC,GAAGyC,KAAH,CACFzC,GAAGkC,QAAH,CAAY,EAAZ,EAAgB,GAAhB,EAAqBQ,aAArB,EADE,EAEF1C,GAAGoC,MAAH,CAAU,EAAV,EAAc,CAAd,EAAiB,CAAC,GAAlB,CAFE,EAGFpC,GAAGuC,OAAH,CAAW,EAAX,EAAe,GAAf,CAHE;AALK,SAAf;;AAYA;AACA,aAAKI,KAAL,GAAa,MAAb;;AAEA;AACA,aAAKC,CAAL,GAAS,GAAT;;AAEA;AACA,aAAKC,UAAL,GAAkB,GAAlB;;AAEA;AACA,aAAKC,OAAL,GAAe,KAAf;;AAEA;AACA,aAAKC,IAAL,GAAY,IAAZ;;AAEA;AACA,aAAKC,aAAL,GAAqB,KAArB;;AAEA;AACA,aAAKC,IAAL,GAAY,KAAZ;;AAEA;AACA,aAAKC,OAAL,GAAe,IAAf;AACH,KAnFmB;AAqFpBC,QArFoB,gBAqFfC,IArFe,EAqFT;AACP,YAAI,KAAKT,KAAL,KAAe,MAAnB,EAA2B;AAC3B,aAAKA,KAAL,GAAa,MAAb;AACA,aAAKtC,IAAL,CAAUgD,SAAV,CAAoB,KAAKrB,OAAL,CAAaC,MAAb,CAAoBqB,OAApB,EAApB;AACA,aAAK7C,KAAL,CAAW4C,SAAX,CAAqBrD,GAAGuD,QAAH,CACjB,KAAKvB,OAAL,CAAaC,MADI,EAEjBjC,GAAGwD,QAAH,CAAYJ,IAAZ,CAFiB,CAArB;AAKH,KA9FmB;AAgGpBK,QAhGoB,kBAgGb;AACH,YAAI,KAAKd,KAAL,KAAe,MAAnB,EAA2B;AAC3B,aAAKA,KAAL,GAAa,MAAb;AACA,aAAKtC,IAAL,CAAUgD,SAAV,CAAoB,KAAKrB,OAAL,CAAaC,MAAjC;AACA,aAAKxB,KAAL,CAAW4C,SAAX,CAAqB,KAAKrB,OAAL,CAAaC,MAAb,CAAoBqB,OAApB,EAArB;AACA,aAAKR,OAAL,GACA,KAAKE,aAAL,GAAqB,KADrB;AAEH,KAvGmB;AAyGpBU,QAzGoB,kBAyGb;AAAA;;AACH,YAAI,KAAKf,KAAL,KAAe,MAAnB,EAA2B;AAC3B,aAAKA,KAAL,GAAa,MAAb;AACA,aAAKgB,IAAL,CAAUN,SAAV,CAAoBrD,GAAGuD,QAAH,CAChB,KAAKvB,OAAL,CAAaG,IADG,EAEhBnC,GAAGwD,QAAH,CAAY,YAAM;AACd,kBAAKL,IAAL,CAAU,MAAKS,IAAL,CAAUC,IAAV,OAAV;AACH,SAFD,CAFgB,CAApB;AAMH,KAlHmB;AAoHpBD,QApHoB,kBAoHb;AAAA;;AACH,YAAI,KAAKjB,KAAL,KAAe,MAAnB,EAA2B;AAC3B,aAAKA,KAAL,GAAa,MAAb;AACA,aAAKgB,IAAL,CAAUN,SAAV,CAAoBrD,GAAGuD,QAAH,CAChB,KAAKvB,OAAL,CAAaK,EADG,EAEhBrC,GAAGwD,QAAH,CAAY,YAAM;AACd,gBAAI,OAAKV,OAAT,EAAkB;AACd,oBAAI,CAAC,OAAKI,OAAV,EAAmB;AACf,2BAAKH,IAAL,CAAUe,MAAV,GAAmB,CAAnB;AACA,2BAAKC,IAAL;AACH,iBAHD,MAGO;AACH;AACA,wBAAI,OAAKb,OAAL,CAAac,aAAb,KAA+B,CAAnC,EAAsC;AAClC,+BAAKjB,IAAL,CAAUe,MAAV,GAAmB,CAAnB;AACA,+BAAKC,IAAL;AACA,+BAAK5C,IAAL,CAAU8C,IAAV,CAAeC,UAAf,CAA0B,OAAKhB,OAA/B;AACH,qBAJD,MAIO,IAAI,OAAKA,OAAL,CAAac,aAAb,KAA+B,CAAnC,EAAsC;AACzC,+BAAKG,GAAL;;AAEA,4BAAI,OAAKjB,OAAL,CAAakB,KAAb,CAAmB7D,IAAnB,KAA4B,CAAhC,EAAmC;AAC/B,mCAAKY,IAAL,CAAU8C,IAAV,CAAeC,UAAf,CAA0B,OAAKhB,OAA/B;AACH,yBAFD,MAEO;AACH;AACA,mCAAK/B,IAAL,CAAU8C,IAAV,CAAeI,MAAf,CAAsBC,IAAtB,CAA2B,OAAKpB,OAAL,CAAakB,KAAb,CAAmBG,GAA9C;AACH;AACJ;AAEJ;AAEJ,aAvBD,MAuBO;AACH,uBAAKd,IAAL;AACA;;;AAGA,uBAAKR,IAAL,GAAY,IAAZ;AACA,uBAAK9B,IAAL,CAAUqD,GAAV,CAAcrB,IAAd,CAAmB,IAAnB,EAAyB,OAAKhC,IAAL,CAAU8C,IAAV,CAAeQ,OAAxC,EACCC,IADD,CACM,eAAO;AACT,2BAAKzB,IAAL,GAAY,KAAZ;AACA,wBAAI0B,IAAIC,IAAJ,CAASC,EAAb,EAAiB,OAAK3B,OAAL,GAAeyB,IAAIC,IAAJ,CAASE,CAAxB,CAAjB,KACK,OAAK5B,OAAL,GAAe,IAAf;AACL,2BAAK/B,IAAL,CAAU4D,IAAV,CAAeC,MAAf;AACH,iBAND,EAMGC,KANH,CAMS,eAAO;AACZ,2BAAKhC,IAAL,GAAY,KAAZ;AACA,2BAAKC,OAAL,GAAe,IAAf;AACA,2BAAK/B,IAAL,CAAU4D,IAAV,CAAeC,MAAf;AACH,iBAVD;AAWH;AACJ,SA1CD,CAFgB,CAApB;AA8CH,KArKmB;AAuKpBE,UAvKoB,oBAuKX;AACL,eAAO,CAAC,EAAEC,KAAKD,MAAL,KAAgB,EAAlB,CAAR;AACH,KAzKmB;AA2KpBf,OA3KoB,iBA2Kd;AACF,aAAKhD,IAAL,CAAU4B,IAAV,CAAeqC,OAAf,CAAuB,KAAKrC,IAA5B;AACA,aAAKU,IAAL;AACH,KA9KmB;AAgLpBM,QAhLoB,kBAgLb;AAAA;;AACH;;;AAGA,aAAKN,IAAL;AACA;AACA,aAAKd,KAAL,GAAa,MAAb;AACA;AACA,aAAKI,IAAL,CAAUsC,cAAV;AACA,aAAKtC,IAAL,CAAUM,SAAV,CAAoBrD,GAAGuD,QAAH,CAChB,KAAKvB,OAAL,CAAaQ,IADG,EAEhBxC,GAAGwD,QAAH,CAAY,YAAM;AACd,mBAAKrC,IAAL,CAAU4B,IAAV,CAAeqC,OAAf,CAAuB,OAAKrC,IAA5B;AACA,mBAAKJ,KAAL,GAAa,MAAb;AACH,SAHD,CAFgB,CAApB;AAOH,KAhMmB;AAkMpB2C,gBAlMoB,0BAkML;AAAA;;AACX,YAAI,KAAKtC,aAAT,EAAwB;AACxB,aAAKA,aAAL,GAAqB,IAArB;AACA,aAAKD,IAAL,CAAUsC,cAAV;AACA,aAAKtC,IAAL,CAAUM,SAAV,CAAoB,KAAKrB,OAAL,CAAaM,KAAjC;AACA,aAAKnB,IAAL,CAAUoE,KAAV,CAAgBzC,OAAhB,CAAwB0C,IAAxB;;AAEA;;;AAGA,aAAKvC,IAAL,GAAY,IAAZ;AACA,aAAK9B,IAAL,CAAUqD,GAAV,CAAcrB,IAAd,CAAmB,KAAKJ,IAAL,CAAU0C,QAA7B,EAAuC,KAAKtE,IAAL,CAAU8C,IAAV,CAAeQ,OAAtD,EACCC,IADD,CACM,eAAO;AACT,mBAAKzB,IAAL,GAAY,KAAZ;AACA,gBAAI0B,IAAIC,IAAJ,CAASC,EAAb,EAAiB,OAAK3B,OAAL,GAAeyB,IAAIC,IAAJ,CAASE,CAAxB,CAAjB,KACK,OAAK5B,OAAL,GAAe,IAAf;AACL,mBAAK/B,IAAL,CAAU4D,IAAV,CAAeC,MAAf;AACH,SAND,EAMGC,KANH,CAMS,eAAO;AACZ,mBAAKhC,IAAL,GAAY,KAAZ;AACA,mBAAKC,OAAL,GAAe,IAAf;AACA,mBAAK/B,IAAL,CAAU4D,IAAV,CAAeC,MAAf;AACH,SAVD;AAWH,KAxNmB;AA0NpBA,UA1NoB,oBA0NX;AACL;AACI;AACJ;AACA,aAAKtE,IAAL,CAAUgF,MAAV,GAAmB,KAAK7C,UAAL,GAAkB,KAAKD,CAAvB,GAA2B,KAAKe,IAAL,CAAUf,CAAxD;;AAEA,YAAI,KAAKE,OAAT,EAAkB;AACd,iBAAKwC,YAAL;AACA,iBAAKvC,IAAL,CAAU4C,CAAV,GAAc,KAAKhC,IAAL,CAAUgC,CAAxB;AACA,iBAAK5C,IAAL,CAAUH,CAAV,GAAc,KAAKe,IAAL,CAAUf,CAAV,GAAc,GAA5B;AACH;AACJ;AArOmB,CAAT,C",
  "file": "unknown",
  "sourcesContent": [
    "export default cc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        left: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        right: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        rope: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        body: {\r\n            default: null,\r\n            type: cc.Node\r\n        }\r\n    },\r\n\r\n    onLoad() {\r\n        this.init()\r\n    },\r\n\r\n    setModel(i) {\r\n        if (i === 3) {\r\n            this.rope.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawRopeGold\r\n            this.body.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawBodyGold\r\n            this.left.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawLeftGold\r\n            this.right.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawRightGold\r\n        } else {\r\n            this.rope.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawRopeNormal\r\n            this.body.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawBodyNormal\r\n            this.left.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawLeftNormal\r\n            this.right.getComponent(cc.Sprite).spriteFrame = this.main.spriteFrames.clawRightNormal\r\n        }\r\n    },\r\n\r\n    init() {\r\n        /*\r\n        * 初始化时\r\n        * 获取 main 组件\r\n        */\r\n        this.main = cc.director.getScene()\r\n            .getChildByName('main').getComponent('main')\r\n\r\n        // 定义动作\r\n        this.actions = {\r\n            rotate: cc.rotateBy(.1, 56),\r\n            move: cc.moveBy(.3, 0, -440),\r\n            up: cc.moveBy(.6, 0, 440),\r\n            scale: cc.scaleBy(.3, .5),\r\n            flop: cc.spawn(\r\n                cc.rotateBy(.8, 360).repeatForever(),\r\n                cc.moveBy(.8, 0, -500),\r\n                cc.scaleBy(.8, 1.5)\r\n            )\r\n        }\r\n\r\n        // 爪子状态\r\n        this.state = 'free'\r\n\r\n        // 爪子初始高度\r\n        this.y = 377\r\n\r\n        // 绳子初始长度\r\n        this.ropeHeight = 120\r\n\r\n        // 是否抓住\r\n        this.catched = false\r\n\r\n        // 抓取的 gift\r\n        this.gift = null\r\n\r\n        // 抓取动画\r\n        this.catchAnimated = false\r\n\r\n        // 接口请求状态\r\n        this.wait = false\r\n\r\n        // 抓取结果\r\n        this.results = null\r\n    },\r\n\r\n    grab(func) {\r\n        if (this.state !== 'fall') return\r\n        this.state = 'grab'\r\n        this.left.runAction(this.actions.rotate.reverse())\r\n        this.right.runAction(cc.sequence(\r\n            this.actions.rotate,\r\n            cc.callFunc(func)\r\n        ))\r\n\r\n    },\r\n\r\n    free() {\r\n        if (this.state !== 'rise') return\r\n        this.state = 'free'\r\n        this.left.runAction(this.actions.rotate)\r\n        this.right.runAction(this.actions.rotate.reverse())\r\n        this.catched =\r\n        this.catchAnimated = false\r\n    },\r\n\r\n    fall() {\r\n        if (this.state !== 'free') return\r\n        this.state = 'fall'\r\n        this.node.runAction(cc.sequence(\r\n            this.actions.move,\r\n            cc.callFunc(() => {\r\n                this.grab(this.rise.bind(this))\r\n            })\r\n        ))\r\n    },\r\n\r\n    rise() {\r\n        if (this.state !== 'grab') return\r\n        this.state = 'rise'\r\n        this.node.runAction(cc.sequence(\r\n            this.actions.up,\r\n            cc.callFunc(() => {\r\n                if (this.catched) {\r\n                    if (!this.results) {\r\n                        this.gift.zIndex = 0\r\n                        this.lose()\r\n                    } else {\r\n                        // 重置 gift zIndex < pit-around\r\n                        if (this.results.grabResultInt === 2) {\r\n                            this.gift.zIndex = 0\r\n                            this.lose()\r\n                            this.main.game.showResult(this.results)\r\n                        } else if (this.results.grabResultInt === 3) {\r\n                            this.win()\r\n\r\n                            if (this.results.goods.type === 0) {\r\n                                this.main.game.showResult(this.results)\r\n                            } else {\r\n                                // 抓到实物的效果\r\n                                this.main.game.prompt.show(this.results.goods.img)\r\n                            }\r\n                        }\r\n\r\n                    }\r\n\r\n                } else {\r\n                    this.free()\r\n                    /*\r\n                    * 请求抓取处理接口\r\n                    */\r\n                    this.wait = true\r\n                    this.main.api.grab(null, this.main.game.matchId)\r\n                    .then(res => {\r\n                        this.wait = false\r\n                        if (res.data.ok) this.results = res.data.r\r\n                        else this.results = null\r\n                        this.main.user.update()\r\n                    }).catch(err => {\r\n                        this.wait = false\r\n                        this.results = null\r\n                        this.main.user.update()\r\n                    })\r\n                }\r\n            })\r\n        ))\r\n    },\r\n\r\n    random() {\r\n        return ~~(Math.random() * 10)\r\n    },\r\n\r\n    win() {\r\n        this.main.gift.putItem(this.gift)\r\n        this.free()\r\n    },\r\n\r\n    lose() {\r\n        /*\r\n        * 掉落\r\n        */\r\n        this.free()\r\n        // 此时要重置 state 为非 free 状态\r\n        this.state = 'rise'\r\n        // 清除 gift action\r\n        this.gift.stopAllActions()\r\n        this.gift.runAction(cc.sequence(\r\n            this.actions.flop,\r\n            cc.callFunc(() => {\r\n                this.main.gift.putItem(this.gift)\r\n                this.state = 'free'\r\n            })\r\n        ))\r\n    },\r\n\r\n    catchAnimate() {\r\n        if (this.catchAnimated) return\r\n        this.catchAnimated = true\r\n        this.gift.stopAllActions()\r\n        this.gift.runAction(this.actions.scale)\r\n        this.main.audio.catched.play()\r\n\r\n        /*\r\n        * 请求抓取处理接口\r\n        */\r\n        this.wait = true\r\n        this.main.api.grab(this.gift._goodsId, this.main.game.matchId)\r\n        .then(res => {\r\n            this.wait = false\r\n            if (res.data.ok) this.results = res.data.r\r\n            else this.results = null\r\n            this.main.user.update()\r\n        }).catch(err => {\r\n            this.wait = false\r\n            this.results = null\r\n            this.main.user.update()\r\n        })\r\n    },\r\n\r\n    update() {\r\n        // console.log(\r\n            // this.node.convertToWorldSpace(0, 0)\r\n        // )\r\n        this.rope.height = this.ropeHeight + this.y - this.node.y\r\n\r\n        if (this.catched) {\r\n            this.catchAnimate()\r\n            this.gift.x = this.node.x\r\n            this.gift.y = this.node.y - 100\r\n        }\r\n    }\r\n\r\n})\r\n"
  ]
}